# ドキュメント粒度標準

## 目的
AIの理解を最大化し、ドキュメントの明瞭性を維持するための最適なファイルおよびディレクトリ構造標準を定義します。

## 1. ファイルサイズ

### 推奨範囲
- **理想的**: ファイルあたり20〜80行
- **警告閾値**: 100行以上
- **分割必須**: 150行以上

### 根拠
- 単一概念の包含：各ファイルは1つの概念を包括的に説明すべきです
- 認知負荷：コンテンツ全体を一目で把握可能
- AI効率：最適なコンテキストウィンドウ利用

### 判断基準
- ✅ ファイルは単一の明確な責務を持っていますか？
- ✅ 独立して理解できますか？
- ❌ 複数の無関係な概念が含まれていますか？

**アクション**: 150行を超えるファイルは論理的なコンポーネントに分割してください。

---

## 2. ファイル命名

### 推奨長さ
- **推奨**: 10〜25文字（`.md`を含む）
- **最小許容**: 8文字（例：`push.md`）
- **最大許容**: 30文字

### 命名パターン

#### 単一語（8〜15文字）
ディレクトリコンテキストが明瞭性を提供する場合に使用：
- `identity.md`
- `commit.md`
- `localization.md`

#### ハイフン区切り2〜3語（16〜30文字）
具体性が必要な場合に使用：
- `code-quality.md`
- `language-standards.md`
- `conversation-logging.md`

### 避けるべきもの
- **略語**: `conv-log.md`、`cont-imp.md`（不明瞭）
- **冗長性**: `continuous-improvement-and-learning-guidelines.md`（過度に冗長）

### 判断基準
- ✅ ファイル名から内容が明確ですか？
- ✅ 一目で読み取れますか？
- ✅ ディレクトリパス + ファイル名で完全なコンテキストが提供されますか？

---

## 3. ディレクトリ内ファイル数

### 推奨範囲
- **理想的**: ディレクトリあたり3〜7ファイル
- **警告閾値**: 10ファイル以上
- **再編成必要**: 12ファイル以上

### 根拠（認知科学）
- **ミラーの法則**: 人間の短期記憶は7±2項目を保持
- 長いリストは認知負荷を増加させます
- カテゴリ化により理解が向上します

### 判断基準
- ✅ ファイルは論理的にグループ化されていますか？
- ✅ より良い整理のためにサブディレクトリを作成すべきですか？
- ❌ 無関係なファイルが混在していますか？

**アクション**: ファイル数が10を超える場合は、サブディレクトリを作成してください。

---

## 4. ディレクトリツリーの深さ

### 推奨深度
- **理想的**: 2〜3階層
- **最大許容**: 4階層

### 例

#### 最適（2階層）
```
.agent/rules/core/identity.md
```

#### 許容可能（3階層）
```
.agent/rules/development/testing/unit-tests.md
```

#### 警告（4階層）
```
.agent/rules/workflow/communication/logging/format.md
```

#### 避けるべき（5階層以上）
深いネストはナビゲーションを困難にし、認知負荷を増加させます。

### 根拠
- **深すぎる**: ナビゲーションが煩雑になり、メンタルモデルの複雑さが増す
- **浅すぎる**: ファイルが散在し、整理が不十分
- **2〜3階層**: バランスの取れた構造、明確な階層

### 判断基準
- ✅ パスから役割が明確ですか？
- ✅ 各階層は意味のある分類を表していますか？
- ❌ 構造が過剰にエンジニアリングされていますか？

---

## 意思決定フレームワーク

### ファイルを分割すべき場合
1. ファイルが150行を超える
2. ファイルに複数の異なる責務が含まれている
3. 独立したセクションが頻繁に個別に参照される

### ファイルを統合すべき場合
1. 関連ファイルが常に一緒に参照される
2. 合計サイズが80行未満
3. 概念的な重複が大きい

### サブディレクトリを作成すべき場合
1. ディレクトリに10以上のファイルが含まれる
2. 明確なサブカテゴリが存在する（例：`testing/`、`deployment/`）
3. 共通の接頭辞を共有するファイルがある（例：`git-commit.md`、`git-push.md` → `git/commit.md`、`git/push.md`）

### ディレクトリ構造をフラット化すべき場合
1. サブディレクトリに1〜2ファイルしか含まれていない
2. 明確な利益なしに深いネスト（4階層以上）がある
3. ディレクトリ名が親コンテキストと冗長である

---

## 現在の構造リファレンス

2025-11-26時点での`.agent/rules/`構造：

```
.agent/rules/
├── README.md (インデックス)
├── core/ (4ファイル) ✓
├── development/ (6ファイル) ✓
├── projects/ (1ファイル) ⚠️
└── workflow/ (3ファイル) ✓

合計: 15ファイル (.md)
深度: 2階層 ✓
```

**ステータス**: 現在の構造はこれらの標準に準拠しています。
